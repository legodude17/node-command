"use strict";function call(e,n,o,r){var t=getArgNames(e),c=[];t.forEach(function(e){e=e.trim(),"args"===e?c.push(n):names.includes(e)?c.push(o):c.push(n.shift())});try{e.apply(r||Object.create(null),c)}catch(l){o()}}var path=require("path"),async=require("async"),ASQ=require("asynquence"),isExe=require("is-executable"),execute=require("child_process").execFile,getArgNames=require("function-args"),names=require("common-callback-names");module.exports=function(e,n,o,r){o=o||{},ASQ(function(r){isExe(e).then(function(t){t?execute(e,n,function(e,n,t){e&&o.logErrors&&console.error(e),o.silent||(n.length&&console.log(n),t.length&&console.error(t.length)),r(!0)}):r()},r.fail)}).then(function(r,t){t&&r(t),isExe(path.join(process.cwd(),"node_modules",".bin",e),function(t){execute(e,n,function(e,n,t){e&&o.logErrors&&console.error(e),o.silent||(n.length&&console.log(n),t.length&&console.error(t.length)),r(!0)})})}).then(function(r,t){if(t)return r(t);var c=!1,l=process.env.PATH.split(path.delimiter);async.forEachOf(l,function(t,l,i){isExe(path.join(t,e)).then(function(r){r?execute(path.join(t,e),n,function(e,n,r){e&&o.logErrors&&console.error(e),c=!0,o.silent||(n.length&&console.log(n),r.length&&console.error(r)),i()}):i()},r.fail)},function(e){return e?r.fail(e):void r(c)})}).then(function(r,t){if(t)return r(!0);try{var c=require.resolve(e)}catch(l){return r(!1)}if(c){if(o.silent){var i=console.log,s=console.error;console.log=console.error=function(){}}call(require(c),n,r.errfcb),setTimeout(r,o.timeout||1e4),o.silent&&(console.log=i,console.error=s)}else r(!1)}).then(function(e,n){r(null,n)})};